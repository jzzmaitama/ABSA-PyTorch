> n_trainable_params: 2525703, n_nontrainable_params: 1375500
> training arguments:
>>> model_name: atae_lstm
>>> dataset: restaurant
>>> optimizer: <class 'transformers.optimization.AdamW'>
>>> initializer: <function xavier_uniform_ at 0x7f5cad6b2040>
>>> lr: 3e-05
>>> dropout: 0
>>> l2reg: 0.01
>>> num_epoch: 20
>>> batch_size: 16
>>> log_step: 10
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> patience: 5
>>> device: cpu
>>> seed: 1234
>>> valset_ratio: 0
>>> local_context_focus: cdm
>>> SRD: 5
>>> model_class: <class 'models.atae_lstm.ATAE_LSTM'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.1800, acc: 0.1812
loss: 1.1788, acc: 0.1812
loss: 1.1750, acc: 0.1854
loss: 1.1703, acc: 0.1906
loss: 1.1682, acc: 0.1925
loss: 1.1643, acc: 0.2010
loss: 1.1633, acc: 0.2009
loss: 1.1591, acc: 0.2070
loss: 1.1550, acc: 0.2104
loss: 1.1500, acc: 0.2162
loss: 1.1446, acc: 0.2199
loss: 1.1399, acc: 0.2193
loss: 1.1338, acc: 0.2274
loss: 1.1277, acc: 0.2469
loss: 1.1207, acc: 0.2683
loss: 1.1127, acc: 0.2883
loss: 1.1039, acc: 0.3077
loss: 1.0961, acc: 0.3247
loss: 1.0891, acc: 0.3391
loss: 1.0816, acc: 0.3538
loss: 1.0746, acc: 0.3673
loss: 1.0710, acc: 0.3764
> val_acc: 0.6500, val_f1: 0.2626
>> saved: state_dict/atae_lstm_restaurant_val_acc_0.65
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.9224, acc: 0.6250
loss: 0.9513, acc: 0.5982
loss: 0.9693, acc: 0.5911
loss: 0.9602, acc: 0.5993
loss: 0.9646, acc: 0.5952
loss: 0.9685, acc: 0.5949
loss: 0.9681, acc: 0.5947
loss: 0.9700, acc: 0.5946
loss: 0.9678, acc: 0.5960
loss: 0.9580, acc: 0.6017
loss: 0.9615, acc: 0.5998
loss: 0.9590, acc: 0.6020
loss: 0.9622, acc: 0.5998
loss: 0.9647, acc: 0.5956
loss: 0.9648, acc: 0.5955
loss: 0.9648, acc: 0.5962
loss: 0.9613, acc: 0.5995
loss: 0.9636, acc: 0.5981
loss: 0.9646, acc: 0.5971
loss: 0.9634, acc: 0.5979
loss: 0.9640, acc: 0.5977
loss: 0.9622, acc: 0.5996
loss: 0.9639, acc: 0.5985
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.9178, acc: 0.6484
loss: 0.9474, acc: 0.6146
loss: 0.9362, acc: 0.6250
loss: 0.9532, acc: 0.6069
loss: 0.9532, acc: 0.6094
loss: 0.9641, acc: 0.6002
loss: 0.9674, acc: 0.5965
loss: 0.9613, acc: 0.6018
loss: 0.9670, acc: 0.5945
loss: 0.9597, acc: 0.6014
loss: 0.9611, acc: 0.5995
loss: 0.9522, acc: 0.6075
loss: 0.9576, acc: 0.6025
loss: 0.9610, acc: 0.5992
loss: 0.9608, acc: 0.5988
loss: 0.9590, acc: 0.5997
loss: 0.9567, acc: 0.6016
loss: 0.9509, acc: 0.6064
loss: 0.9538, acc: 0.6037
loss: 0.9531, acc: 0.6039
loss: 0.9553, acc: 0.6025
loss: 0.9591, acc: 0.5983
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 1.0404, acc: 0.5000
loss: 0.9695, acc: 0.5938
loss: 0.9730, acc: 0.5881
loss: 0.9942, acc: 0.5645
loss: 0.9754, acc: 0.5848
loss: 0.9678, acc: 0.5901
loss: 0.9612, acc: 0.5958
loss: 0.9604, acc: 0.5972
loss: 0.9640, acc: 0.5930
loss: 0.9652, acc: 0.5904
loss: 0.9670, acc: 0.5870
loss: 0.9681, acc: 0.5859
loss: 0.9686, acc: 0.5856
loss: 0.9669, acc: 0.5871
loss: 0.9626, acc: 0.5920
loss: 0.9607, acc: 0.5933
loss: 0.9588, acc: 0.5957
loss: 0.9577, acc: 0.5963
loss: 0.9566, acc: 0.5972
loss: 0.9596, acc: 0.5944
loss: 0.9597, acc: 0.5938
loss: 0.9579, acc: 0.5961
loss: 0.9534, acc: 0.5999
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.9697, acc: 0.5833
loss: 0.9489, acc: 0.6055
loss: 0.9536, acc: 0.5986
loss: 0.9535, acc: 0.6007
loss: 0.9625, acc: 0.5938
loss: 0.9678, acc: 0.5882
loss: 0.9646, acc: 0.5890
loss: 0.9649, acc: 0.5880
loss: 0.9624, acc: 0.5908
loss: 0.9618, acc: 0.5918
loss: 0.9588, acc: 0.5949
loss: 0.9606, acc: 0.5932
loss: 0.9615, acc: 0.5923
loss: 0.9613, acc: 0.5924
loss: 0.9558, acc: 0.5972
loss: 0.9561, acc: 0.5970
loss: 0.9553, acc: 0.5975
loss: 0.9546, acc: 0.5984
loss: 0.9513, acc: 0.6008
loss: 0.9509, acc: 0.6014
loss: 0.9496, acc: 0.6025
loss: 0.9500, acc: 0.6021
loss: 0.9519, acc: 0.5998
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 1.0139, acc: 0.5437
loss: 0.9833, acc: 0.5750
loss: 0.9711, acc: 0.5854
loss: 0.9765, acc: 0.5781
loss: 0.9717, acc: 0.5837
loss: 0.9656, acc: 0.5896
loss: 0.9583, acc: 0.5955
loss: 0.9538, acc: 0.5992
loss: 0.9502, acc: 0.6014
loss: 0.9496, acc: 0.6012
loss: 0.9536, acc: 0.5972
loss: 0.9525, acc: 0.5984
loss: 0.9521, acc: 0.5981
loss: 0.9488, acc: 0.6009
loss: 0.9478, acc: 0.6017
loss: 0.9468, acc: 0.6031
loss: 0.9483, acc: 0.6018
loss: 0.9523, acc: 0.5986
loss: 0.9497, acc: 0.6013
loss: 0.9514, acc: 0.6000
loss: 0.9517, acc: 0.5994
loss: 0.9529, acc: 0.5983
> val_acc: 0.6500, val_f1: 0.2626
>> test_acc: 0.6500, test_f1: 0.2626
